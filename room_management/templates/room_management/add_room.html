{% extends 'base.html' %}
{% load static %}

{% block title %}Add Room{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="row">
        <div class="col-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'room_management:room_list' %}">Rooms</a></li>
                    <li class="breadcrumb-item active">Add Room</li>
                </ol>
            </nav>
        </div>
    </div>

    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-12">
            <h2><i class="bi bi-plus-circle me-2"></i>{{ title }}</h2>
            <p class="text-muted">Create a new room in the system</p>
        </div>
    </div>

    <!-- Add Room Form -->
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="bi bi-door-open me-2"></i>Room Information
                    </h5>
                </div>
                <div class="card-body">                    <form method="POST" enctype="multipart/form-data" id="addRoomForm">
                        {% csrf_token %}
                        
                        <!-- Room Basic Info -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="{{ form.room_name.id_for_label }}" class="form-label">
                                    <i class="bi bi-tag me-1"></i>Room Name <span class="text-danger">*</span>
                                </label>
                                {{ form.room_name }}
                                {% if form.room_name.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.room_name.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.room_number.id_for_label }}" class="form-label">
                                    <i class="bi bi-hash me-1"></i>Room Number <span class="text-danger">*</span>
                                </label>
                                {{ form.room_number }}
                                {% if form.room_number.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.room_number.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Room Type and Capacity -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="{{ form.room_type.id_for_label }}" class="form-label">
                                    <i class="bi bi-diagram-3 me-1"></i>Room Type <span class="text-danger">*</span>
                                </label>
                                {{ form.room_type }}
                                {% if form.room_type.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.room_type.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.capacity.id_for_label }}" class="form-label">
                                    <i class="bi bi-people me-1"></i>Capacity <span class="text-danger">*</span>
                                </label>
                                {{ form.capacity }}
                                {% if form.capacity.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.capacity.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Location -->
                        <div class="row mb-3">
                            <div class="col-12">
                                <label for="{{ form.location.id_for_label }}" class="form-label">
                                    <i class="bi bi-geo-alt me-1"></i>Location <span class="text-danger">*</span>
                                </label>
                                {{ form.location }}
                                {% if form.location.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.location.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">Specify the floor, building, or area where this room is located.</div>
                            </div>
                        </div>                        <!-- Facilities -->
                        <div class="row mb-3">
                            <div class="col-12">
                                <label for="{{ form.facilities.id_for_label }}" class="form-label">
                                    <i class="bi bi-gear me-1"></i>Facilities
                                </label>
                                {{ form.facilities }}
                                {% if form.facilities.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.facilities.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">List available facilities (e.g., projector, whiteboard, air conditioning).</div>
                            </div>
                        </div>

                        <!-- Description -->
                        <div class="row mb-3">
                            <div class="col-12">
                                <label for="{{ form.description.id_for_label }}" class="form-label">
                                    <i class="bi bi-card-text me-1"></i>Description
                                </label>
                                {{ form.description }}
                                {% if form.description.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.description.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">Provide additional details about this room.</div>
                            </div>
                        </div>

                        <!-- Cover Image -->
                        <div class="row mb-3">
                            <div class="col-12">
                                <label for="{{ form.cover_image.id_for_label }}" class="form-label">
                                    <i class="bi bi-image me-1"></i>Cover Image
                                </label>
                                {{ form.cover_image }}
                                {% if form.cover_image.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.cover_image.errors.0 }}
                                    </div>
                                {% endif %}
                                <div class="form-text">Upload an image to represent this room (optional).</div>
                            </div>
                        </div>

                        <!-- Status -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="{{ form.status.id_for_label }}" class="form-label">
                                    <i class="bi bi-circle-fill me-1"></i>Status
                                </label>
                                {{ form.status }}
                                {% if form.status.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.status.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Active Status -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <div class="form-check">
                                    {{ form.is_active }}
                                    <label class="form-check-label" for="{{ form.is_active.id_for_label }}">
                                        <i class="bi bi-check-circle me-1"></i>Room is active and available for booking
                                    </label>
                                </div>
                                {% if form.is_active.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.is_active.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="row">
                            <div class="col-12 d-flex justify-content-between">
                                <a href="{% url 'room_management:room_list' %}" class="btn btn-outline-secondary">
                                    <i class="bi bi-arrow-left me-2"></i>Back to Rooms
                                </a>
                                <div>
                                    <button type="reset" class="btn btn-outline-warning me-2">
                                        <i class="bi bi-arrow-clockwise me-2"></i>Reset Form
                                    </button>
                                    <button type="submit" class="btn btn-success">
                                        <i class="bi bi-plus-circle me-2"></i>Create Room
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Add Bootstrap classes to form fields
    const formFields = document.querySelectorAll('input, select, textarea');
    formFields.forEach(field => {
        if (!field.classList.contains('form-check-input')) {
            field.classList.add('form-control');
        }
    });
    
    // Form validation
    document.getElementById('addRoomForm').addEventListener('submit', function(e) {
        const requiredFields = this.querySelectorAll('[required]');
        let isValid = true;
        
        requiredFields.forEach(field => {
            if (!field.value.trim()) {
                field.classList.add('is-invalid');
                isValid = false;
            } else {
                field.classList.remove('is-invalid');
            }
        });
        
        if (!isValid) {
            e.preventDefault();
            alert('Please fill in all required fields.');
        }
    });
      // Auto-generate room number suggestion
    const roomNameField = document.getElementById('id_room_name');
    const roomNumberField = document.getElementById('id_room_number');
    
    if (roomNameField && roomNumberField) {
        roomNameField.addEventListener('blur', function() {
            if (!roomNumberField.value && this.value) {
                // Generate room number from name
                const suggestion = this.value.replace(/\s+/g, '').substring(0, 3).toUpperCase() + 
                                  Math.floor(Math.random() * 900 + 100);
                roomNumberField.value = suggestion;
            }
        });
    }
});
</script>
{% endblock %}